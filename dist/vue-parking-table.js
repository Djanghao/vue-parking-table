(function(v,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(v=typeof globalThis<"u"?globalThis:v||self,t(v.VueParkingTable={},v.Vue))})(this,function(v,t){"use strict";const E=(l,n)=>Math.abs(l.row-n.row)+Math.abs(l.col-n.col),O=(l,n,a)=>!!(a.row<n.row&&l[a.row][a.col].horizontalLine||a.row>n.row&&l[n.row][n.col].horizontalLine||a.col<n.col&&l[a.row][a.col].verticalLine||a.col>n.col&&l[n.row][n.col].verticalLine),$=(l,n,a,r)=>{const{row:c,col:f}=l,p=[],u=[{row:-1,col:0},{row:0,col:1},{row:1,col:0},{row:0,col:-1}];for(const m of u){const d=c+m.row,k=f+m.col;if(d>=0&&d<a&&k>=0&&k<r){const b=n[d][k];if(b.type==="open-area"||b.type==="parking-space"){const C={row:c,col:f},y={row:d,col:k};O(n,C,y)||p.push(y)}}}return p},_=(l,n,a,r,c)=>{if(!l||!n)return null;const f=a[l.row][l.col],p=a[n.row][n.col];if(!((f.type==="open-area"||f.type==="parking-space")&&(p.type==="open-area"||p.type==="parking-space")))return null;const u=[l],m=new Set,d={},k={},b={};for(let y=0;y<r;y++)for(let w=0;w<c;w++){const P=`${y}-${w}`;k[P]=1/0,b[P]=1/0}const C=`${l.row}-${l.col}`;for(k[C]=0,b[C]=E(l,n);u.length>0;){let y=0;for(let h=1;h<u.length;h++){const g=`${u[h].row}-${u[h].col}`,V=`${u[y].row}-${u[y].col}`;b[g]<b[V]&&(y=h)}const w=u[y],P=`${w.row}-${w.col}`;if(w.row===n.row&&w.col===n.col){const h=[];let g=w;for(;d[`${g.row}-${g.col}`];)h.push(g),g=d[`${g.row}-${g.col}`];return h.push(l),h.reverse()}u.splice(y,1),m.add(P);const T=$(w,a,r,c);for(const h of T){const g=`${h.row}-${h.col}`;if(m.has(g))continue;const V=k[P]+1;if(!u.some(e=>e.row===h.row&&e.col===h.col))u.push(h);else if(V>=k[g])continue;d[g]=w,k[g]=V,b[g]=k[g]+E(h,n)}}return null},B=l=>{if(!l)return[];const n=l.split(`
`).filter(r=>r.trim()!==""),a=[];for(let r=0;r<n.length;r++){const c=n[r].split(",").map(f=>f.trim());a.push(c)}return a},D=(l,n,a)=>{if(!l||!Array.isArray(l)||l.length===0)return null;if(n>=0&&n<l.length&&a>=0&&l[n]&&a<l[n].length){const r=l[n][a];return r&&r!==""?r:null}return null},F=(l,n)=>{const a=l.__vccOpts||l;for(const[r,c]of n)a[r]=c;return a},I={name:"ParkingTable",setup(){const a=t.ref([]),r=t.ref([]),c=t.ref(null),f=t.ref(null),p=t.ref([]),u=t.ref(!1),m=t.ref(""),d=(e=null)=>{if(e&&Array.isArray(e)&&e.length===20&&e[0].length===30)return e;const s=[];for(let o=0;o<20;o++){const i=[];for(let S=0;S<30;S++)i.push({type:"open-area",horizontalLine:!1,verticalLine:!1});s.push(i)}return s},k=async()=>{try{const e=await fetch("/src/assets/parking-lot-design.csv");if(!e.ok){console.error("Failed to load CSV file:",e.statusText);return}const s=await e.text();r.value=B(s),console.log("Parking spot IDs loaded from CSV:",r.value)}catch(e){console.error("Error loading parking spot IDs from CSV:",e)}},b=(e,s)=>D(r.value,e,s),C=()=>{if(!m.value.trim())return;const e=m.value.trim(),s=[];for(let o=0;o<a.value.length;o++)for(let i=0;i<a.value[o].length;i++)a.value[o][i].number===e&&s.push({row:o,col:i});if(s.length===0){for(let o=0;o<r.value.length;o++)if(r.value[o]){for(let i=0;i<r.value[o].length;i++)if(r.value[o][i]===e&&o<a.value.length&&i<a.value[o].length){const S=a.value[o][i];(S.type==="parking-space"||S.type==="open-area")&&s.push({row:o,col:i})}}}s.length>0?(f.value=s[0],c.value&&(y(),u.value=!0),alert(`End point set to spot "${e}" successfully!`)):alert(`No spot with ID "${e}" found!`)},y=()=>{c.value&&f.value&&(p.value=[],t.nextTick(()=>{const e=_(c.value,f.value,a.value,20,30);p.value=e||[]}))},w=async()=>{try{await k();const e=await fetch("/src/assets/parking-lot-design.json");if(!e.ok){console.error("Failed to load JSON file:",e.statusText);return}const s=await e.json();a.value=d(s.grid),c.value={row:18,col:27},f.value=null,p.value=[],u.value=!1,console.log("Parking lot design loaded successfully")}catch(e){console.error("Error loading parking lot design:",e)}},P=(e,s,o)=>{const i=["grid-cell"];o.type&&i.push(o.type),o.horizontalLine&&i.push("parking-line-h"),o.verticalLine&&i.push("parking-line-v");const S=L(e,s,o)!==null;return c.value&&c.value.row===e&&c.value.col===s&&(i.push("start-point"),S&&i.push("with-number")),f.value&&f.value.row===e&&f.value.col===s&&(i.push("end-point"),S&&i.push("with-number")),h(e,s)&&!(c.value&&c.value.row===e&&c.value.col===s)&&!(f.value&&f.value.row===e&&f.value.col===s)&&(S?i.push("path-with-number"):i.push("path")),i},T=(e,s)=>h(e,s)&&!(c.value&&c.value.row===e&&c.value.col===s)&&!(f.value&&f.value.row===e&&f.value.col===s)?{"animation-delay":V(e,s)}:{},h=(e,s)=>u.value&&p.value.some(o=>o.row===e&&o.col===s),g=(e,s)=>p.value.findIndex(o=>o.row===e&&o.col===s),V=(e,s)=>{const o=g(e,s);if(o===-1)return 0;const i=p.value.length;if(i<=1)return 0;const S=.3/(i-1),W=o*S;return Math.min(W,.3).toFixed(3)+"s"},L=(e,s,o)=>o.type!=="parking-space"&&o.type!=="open-area"?null:o.number?o.number:b(e,s);return t.onMounted(()=>{w()}),{grid:a,startPoint:c,endPoint:f,path:p,isPathVisible:u,spotIdToSearch:m,handleSpotSearch:C,getCellClasses:P,getCellStyles:T,getDisplayParkingNumber:L}}},M={class:"parking-table"},z={class:"search-container"},K={class:"grid-container"},R={key:0,class:"parking-number"};function A(l,n,a,r,c,f){return t.openBlock(),t.createElementBlock("div",M,[t.createElementVNode("div",z,[t.withDirectives(t.createElementVNode("input",{type:"text",class:"spot-search-input","onUpdate:modelValue":n[0]||(n[0]=p=>r.spotIdToSearch=p),placeholder:"Enter license plate...",onKeyup:n[1]||(n[1]=t.withKeys((...p)=>r.handleSpotSearch&&r.handleSpotSearch(...p),["enter"]))},null,544),[[t.vModelText,r.spotIdToSearch]]),t.createElementVNode("button",{class:"search-button",onClick:n[2]||(n[2]=(...p)=>r.handleSpotSearch&&r.handleSpotSearch(...p))}," Find Route ")]),t.createElementVNode("div",K,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(r.grid,(p,u)=>(t.openBlock(),t.createElementBlock(t.Fragment,{key:u},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(p,(m,d)=>(t.openBlock(),t.createElementBlock("div",{key:`${u}-${d}`,class:t.normalizeClass(r.getCellClasses(u,d,m)),style:t.normalizeStyle(r.getCellStyles(u,d))},[r.getDisplayParkingNumber(u,d,m)?(t.openBlock(),t.createElementBlock("span",R,t.toDisplayString(r.getDisplayParkingNumber(u,d,m)),1)):t.createCommentVNode("",!0)],6))),128))],64))),128))])])}const N=F(I,[["render",A]]),j={install(l){l.component("ParkingTable",N)}};v.VueParkingTablePlugin=j,v.default=N,v.findPath=_,v.getSpotIdFromCSV=D,v.parseCSV=B,Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
